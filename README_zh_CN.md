[英文](README.md)


## 基于文档搜索
### 特性
* 以文档为单位进行搜索
* 可设置搜索块的类型（与官方搜索类型隔离，互不影响。）
* 支持过滤不常用笔记本
* 支持手机端使用（需要开启Dock栏）


### 功能

#### 单击搜索结果进行定位
单击搜索结果块，支持在文档中进行定位。在长表格或代码块中体验良好。

![Image](https://github.com/Misuzu2027/syplugin-document-search/blob/main/src/assets/imgs/click-result-positioning.gif?raw=true)

#### 标签页双击搜索结果打开文档页签
标签页双击搜索结果打开文档，并跳转到指定位置。如果双击后没有打开，可以在“其他”设置中，把“双击时间阈值”调大点。


#### 单篇文档搜索结果排序
* 触发方式：
  * 桌面端右键单击文档
  * 手机端长按文档

![Image](https://github.com/Misuzu2027/syplugin-document-search/blob/main/src/assets/imgs/sorting-menu.png?raw=true)


#### 支持方向键选择
光标在输入框中时，可以上下键选择搜索结果，回车键打开结果标签页。


#### 代码块、数据库高亮
页签搜索预览区 或 dock栏单击打开文档后 支持 **代码块、数据库** 关键字高亮和定位！（官方搜索目前不支持）
如果  **代码块、数据库** 的高亮失效，可以再“其他”设置中，把“刷新预览区高亮延迟”调大点。


#### Dock栏搜索 支持在当前文档搜索
![Alt text](https://github.com/Misuzu2027/syplugin-document-search/blob/main/src/assets/imgs/search-in-document.png?raw=true)

关闭是全局搜索，打开后在当前文档搜索；打开后或强制使用原文排序，如果想要切换排序可以右击文档进行切换。

实际上是读取光标最后聚焦的文档，如果没有定位到想要的文档，可以切换页签或重新打开该文档。


## 扁平化文档树
### 特性
* 官方文档树对文档的操作，这里都支持。
  * 注意：重命名、删除、新建文档 等操作需要手动刷新才会展示最新数据。
* 支持手机端使用（需要开启Dock栏）
### 功能
* 支持以修改时间、创建时间、引用次数进行排序。
* 搜索框支持文档名搜索。

## 隐藏 Dock
可以在插件的设置 Dock设置 中对不需要的 Dock 进行隐藏。
注意：手机端会同步隐藏


## 查询语法
`@`接特定字母使用查询语法，`@`或关键字前面加减号`-`就是排除这个条件的块；建议`-`排除语法最好在最后使用，否则会先查询出所有不符合条件的块，比较卡。

### 关键字查询

#### 开启全文搜索
* `工作 测试`：查询同时含有`工作`、`测试`的文档；然后显示含有 `工作`或`测试`的块
* `-工作 测试`：查询不含`工作`，含有`测试`的文档；然后显示含有 `测试` 的块

#### 关闭全文搜索
* `工作 测试`：查询同时含有`工作`、`测试`的块。
* `-工作 测试`：查询不含`工作`，含有`测试`的块。

### `@b` 笔记本过滤
* `@b生活`：显示包含`生活`关键字的笔记本中的文档
* `-@b生活`：显示不包含`生活`关键字的笔记本中的文档
* 可以组合查询，列如 `@b生活 @b工作` 显示包含`生活` **和** `工作` 笔记本中的文档

### `@p` 路径过滤
* `@p兴趣`：显示路径包含`兴趣`关键字的文档
* `-@p兴趣`：显示路径不包含`兴趣`关键字的文档
* 可组合查询。

如果想查看文档 `兴趣爱好` 下的所有子文档，但是不包含 `兴趣爱好`，可以使用 `@p兴趣%/`，在结尾添加 `%/` 表示子文档。

### `@c` 创建时间 `@u` 更新时间
时间或日期值采用 yyyyMMddhhmmss 格式，列如 2025年03月31日14:42:04 就是 `20250331144204`。

* 查询2025年03月创建（更新）的笔记：`@c202503`、`@c=202503`、`@ceq202503`
* 查询2025年03月15号之后创建（更新）的笔记：`@c>20250315`、`@cgt20250315`
* 查询2025年之前创建的笔记：`@c<2025`、`@clt2025`
* 查询2024年11月的笔记：`@c>202411 @c<202412`

### `@t` 按照块类型匹配关键字
块类型跟数据库中的 `blocks.type` 值一样： `d ` 文档 |  `h ` 标题 |  `l ` 列表 |  `i ` 列表项 |  `c ` 代码块 |  `m ` 数学公式 |  `t ` 表格 |  `b ` 引述 |  `av ` 属性视图（数据库） |  `s ` 超级块 |  `p ` 段落 |  `tb ` 表格 |  `html ` HTML |  `video ` 视频 |  `audio ` 音频 |  `widget ` 挂件 |  `iframe ` iframe |  `query_embed ` 嵌入块 

* `@tav`：查询所有数据库块。
* `@th紫罗兰`：查询含有`紫罗兰`的标题块。
* `-@th紫罗兰`：查询不包含`紫罗兰`的标题块 此外的所有块；如果单单这个条件，基本上会返回许多块，所以建议先写包含的关键字，再根据搜索结果排除。
* `@th -@th紫罗兰`：查询标题块，排除包含`紫罗兰`的标题块。
* `@th @tp紫罗兰`：查询所有标题块，查询所有包含`紫罗兰`的段落块。

注意：开启全文搜索和不开全文搜索结果会不一样，全文搜索会以文档为单位来排除。每个块类型之间是(OR)
* 列如：`@th紫罗兰 -@th花园` 查询含有 `紫罗兰` 的标题块，排除含有 `花园` 的标题块。
  * 如果开启全文搜索，那么含有 `紫罗兰` 的标题块，同时含有 `花园` 标题块的文档都会被过滤。
  * 关闭全文搜索，就会显示含有 `紫罗兰` 的标题块，同文档下含有 `花园` 标题块会被过滤，不会影响整个文档。

## 默认配置

### 基于文档搜索

*  默认查询的块类型：
  * 文档, 标题, 代码块, 数学公式块, 表格块, 段落块, html块, 数据库，音频，视频
* 默认会匹配块的 命名、别名、备注
* 默认排序方式：
  * 文档排序：相关度降序
  * 内容块排序：类型
* 每页文档数量：10
* 默认最大展开数量：100


### 扁平化文档树

* 默认修改时间降序
* 展示30条


### 快捷键

* 目前支持快捷键的操作：打开文档搜索页签、文档搜索 Dock、扁平化文档树 Dock 。
* 均可在 思源笔记设置 -> 快捷键 -> 基于文档搜索 中找到并修改：

# 更新记录
> [更新记录](./CHANGELOG_zh_CN.md)